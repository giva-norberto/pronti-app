<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil e Configurações - Pronti</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <!-- FontAwesome para ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <style>
        body.is-loading {visibility:hidden;opacity:0;transition:opacity 0.3s;}
        #sidebar-placeholder {float:left;width:250px;min-width:250px;height:100vh;}
        .main-content {margin-left:250px;padding:32px 24px 24px 24px;min-height:100vh;box-sizing:border-box;width:calc(100% - 250px);}
        @media (max-width:1200px){
            .main-content {margin-left:0;width:100%;padding:24px;}
            #sidebar-placeholder{float:none;width:100%;height:auto;min-width:unset;}
        }
        .card#form-perfil {
            max-width: 800px;
            margin: 32px auto 0 auto;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.06);
            padding: 32px 24px;
        }
        /* Garante responsividade do formulário e alinhamento dos botões */
        @media (max-width: 700px) {
            .card#form-perfil {
                padding: 16px 6vw;
            }
        }
    </style>
</head>
<body class="is-loading">
    <!-- Menu lateral carregado dinamicamente ->
    <div id="sidebar-placeholder"></div>

    <main class="main-content">
        <div class="page-header">
            <h1>Meu Perfil e Configurações</h1>
            <a id="btn-abrir-vitrine" href="#" target="_blank" class="btn btn-primary" style="display: none;">
                <i class="fa-solid fa-store"></i> Abrir Minha Vitrine
            </a>
        </div>

        <!-- O formulário agora usa a classe .card para um visual consistente -->
        <form id="form-perfil" class="card">
            <div class="card-info" style="padding: 24px;">
                <div class="form-section">
                    <h3>Informações do Negócio</h3>
                    <div class="form-group">
                        <label for="nomeNegocio">Nome do Negócio</label>
                        <input type="text" id="nomeNegocio" class="form-input" placeholder="Ex: Barbearia do João" required>
                    </div>
                    <div class="form-group" id="container-link-vitrine" style="display: none;">
                        <label>Link da sua Vitrine Pública</label>
                        <div class="vitrine-link-container">
                            <div class="vitrine-url" id="url-vitrine-display"></div>
                            <div class="vitrine-actions">
                                <button type="button" id="btn-copiar-link" class="btn btn-sucesso">
                                    <i class="fa-regular fa-copy"></i> Copiar
                                </button>
                                <a href="#" target="_blank" class="btn btn-edit" id="btn-abrir-vitrine-inline">
                                    <i class="fa-solid fa-arrow-up-right-from-square"></i> Abrir
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="logoNegocio">Logótipo do Negócio (Opcional)</label>
                        <div class="logo-upload-container">
                            <img id="logo-preview" src="https://placehold.co/100x100/eef2ff/4f46e5?text=Logo" alt="Pré-visualização do logotipo">
                            <div class="logo-upload-actions">
                                <input type="file" id="logoNegocio" accept="image/png, image/jpeg" style="display: none;">
                                <button type="button" id="btn-upload-logo" class="btn btn-aviso">
                                    <i class="fa-regular fa-image"></i> Escolher Arquivo
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="descricao">Descrição Curta</label>
                        <textarea id="descricao" rows="3" class="form-input" placeholder="Uma breve descrição do seu negócio."></textarea>
                    </div>
                </div>
            </div>
            <div class="card-actions">
                <button type="submit" class="btn btn-primary">
                    <i class="fa-solid fa-floppy-disk"></i> Salvar Todas as Configurações
                </button>
            </div>
        </form>
    </main>
    
    <!-- Scripts -->
    <script>
    // Inclusão dinâmica do menu lateral e destaque do menu de perfil
    document.addEventListener("DOMContentLoaded", function() {
      fetch('menu-lateral.html')
        .then(res => res.ok ? res.text() : Promise.reject('Erro ao carregar menu.'))
        .then(html => {
          document.getElementById('sidebar-placeholder').innerHTML = html;
          const activeLink = document.querySelector('.sidebar-links a[href="perfil.html"]');
          if (activeLink) {
            document.querySelectorAll('.sidebar-links a.active').forEach(link => link.classList.remove('active'));
            activeLink.classList.add('active');
          }
          document.body.classList.remove('is-loading');
        })
        .catch(error => {
          console.error('Erro ao carregar o menu lateral:', error);
          document.body.classList.remove('is-loading');
        });

      // Lógica dos botões da UI
      document.getElementById('btn-upload-logo').onclick = () => document.getElementById('logoNegocio').click();
      
      const btnCopiar = document.getElementById('btn-copiar-link');
      if (btnCopiar) {
        btnCopiar.onclick = function() {
          const url = document.getElementById('url-vitrine-display').innerText;
          if (!url) return;
          navigator.clipboard.writeText(url).then(() => {
            btnCopiar.innerHTML = '<i class="fa-solid fa-check"></i> Copiado!';
            setTimeout(() => {
              btnCopiar.innerHTML = '<i class="fa-regular fa-copy"></i> Copiar';
            }, 1500);
          });
        };
      }
    });
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="perfil.js" type="module"></script>
</body>
</html>
