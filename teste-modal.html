<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Teste de Modal</title>
</head>
<body>

    <h1>Página de Teste do Modal</h1>
    <p>O objetivo desta página é verificar se o modal de confirmação funciona em um ambiente limpo.</p>
    <button id="botao-teste" style="padding: 10px 20px; font-size: 16px;">Testar Exclusão</button>

    <div id="custom-modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal-box">
            <h2 id="modal-title">Título Padrão</h2>
            <p id="modal-message">Mensagem padrão.</p>
            <div id="modal-buttons-container" class="modal-buttons"></div>
        </div>
    </div>

    <style>
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-box { background: white; padding: 30px; border-radius: 12px; text-align: center; max-width: 420px; width: 90%; }
        .modal-buttons { display: flex; justify-content: center; gap: 15px; margin-top: 20px; }
        .btn-ok { background-color: #007BFF; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-cancel { background-color: #e9ecef; color: #333; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; }
    </style>

    <script>
        // Espera o HTML estar 100% pronto antes de executar qualquer código
        document.addEventListener('DOMContentLoaded', () => {
            console.log("Página de teste carregada. O HTML está pronto.");

            const botaoTeste = document.getElementById('botao-teste');
            
            // Função do modal (versão simplificada do nosso vitrini-utils.js)
            function showCustomConfirm(title, message) {
                return new Promise(resolve => {
                    console.log("showCustomConfirm foi chamada. Procurando elementos do modal...");
                    const overlay = document.getElementById('custom-modal-overlay');
                    const titleEl = document.getElementById('modal-title');
                    const messageEl = document.getElementById('modal-message');
                    const buttonsContainer = document.getElementById('modal-buttons-container');

                    if (!overlay || !titleEl || !messageEl || !buttonsContainer) {
                        console.error("ERRO CRÍTICO: Elementos do modal não encontrados no DOM nesta página de teste!");
                        alert("ERRO: Elementos do modal não encontrados no DOM.");
                        return resolve(false);
                    }
                    
                    console.log("Elementos do modal encontrados com sucesso!");

                    titleEl.textContent = title;
                    messageEl.textContent = message;
                    buttonsContainer.innerHTML = '';

                    const close = (value) => {
                        overlay.style.display = 'none';
                        resolve(value);
                    };

                    const btnConfirmar = document.createElement('button');
                    btnConfirmar.textContent = 'Confirmar';
                    btnConfirmar.className = 'btn-ok';
                    btnConfirmar.onclick = () => close(true);

                    const btnCancelar = document.createElement('button');
                    btnCancelar.textContent = 'Cancelar';
                    btnCancelar.className = 'btn-cancel';
                    btnCancelar.onclick = () => close(false);

                    buttonsContainer.appendChild(btnCancelar);
                    buttonsContainer.appendChild(btnConfirmar);

                    overlay.style.display = 'flex';
                });
            }

            // Adiciona o evento de clique ao botão de teste
            botaoTeste.addEventListener('click', async () => {
                console.log("Botão de teste clicado. Chamando o modal...");
                const confirmado = await showCustomConfirm("Teste de Exclusão", "Você confirma?");
                
                if (confirmado) {
                    alert("Você clicou em CONFIRMAR! O teste funcionou.");
                } else {
                    alert("Você clicou em CANCELAR. O teste também funcionou.");
                }
            });
        });
    </script>

</body>
</html>
