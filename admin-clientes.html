<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Administra√ß√£o de Clientes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- 1. Carrega o React e o ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- 2. Carrega o Babel Standalone para compilar o JSX no navegador -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 3. Carrega os SDKs do Firebase (vers√£o compat, mais f√°cil de usar sem m√≥dulos ) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

    <!-- Estilos da p√°gina e da sidebar -->
    <style>
        /* Seus estilos da sidebar e da p√°gina v√£o aqui... (copie e cole da sua vers√£o anterior ) */
        body { font-family: Arial, sans-serif; background: #f6f6fa; margin: 0; }
        .main { margin-left: 260px; padding: 32px; }
        @media (max-width: 900px) { .main { margin-left: 0; } }
        .container { max-width: 700px; margin: 40px auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 10px #0001; padding: 32px; }
        h2 { font-size: 1.7em; margin-bottom: 24px; }
        .empresa { border: 1px solid #eee; margin-bottom: 32px; border-radius: 8px; padding: 16px; background: #fafbfc; }
        .empresa-header { display: flex; align-items: center; justify-content: space-between; }
        .empresa-status { font-weight: bold; }
        .btn-block { background: #dc2626; color: #fff; border: none; border-radius: 4px; padding: 6px 18px; cursor: pointer; }
        .btn-unblock { background: #10b981; color: #fff; border: none; border-radius: 4px; padding: 6px 18px; cursor: pointer; }
        table { width: 100%; margin-top: 8px; border-collapse: collapse; }
        th, td { padding: 6px 9px; }
        thead tr { background: #f3f4f6; }
        tbody tr.blocked { background: #fde2e2; }
        .loading, .restricted { padding: 32px; text-align: center; font-size: 1.1em; }
        .sidebar { width: 240px; background: linear-gradient(180deg, #4f46e5 0%, #6366f1 100%); min-height: 100vh; color: #fff; box-shadow: 2px 0 8px rgba(0,0,0,0.05); position: fixed; left: 0; top: 0; bottom: 0; z-index: 10; display: flex; flex-direction: column; padding-top: 24px; }
        .sidebar-brand { font-size: 2rem; font-weight: 900; color: #fff; text-decoration: none; letter-spacing: 2px; padding: 0 32px 12px 32px; display: block; margin-bottom: 8px; text-align: left; }
        .sidebar hr { margin: 0 32px 16px 32px; border: none; border-top: 1px solid #787cff55; }
        .sidebar-links { display: flex; flex-direction: column; gap: 10px; padding: 0 24px; }
        .sidebar-links a { display: flex; align-items: center; gap: 10px; background: #fff; color: #4f46e5; font-weight: 600; font-size: 1.08em; border-radius: 10px; margin-bottom: 0; box-shadow: 0 2px 6px rgba(79,70,229,0.07); transition: background 0.17s, color 0.18s, box-shadow 0.18s; padding: 12px 18px; text-align: left; text-decoration: none; letter-spacing: 0.01em; border: 2px solid transparent; }
        .sidebar-links a.active, .sidebar-links a:focus { background: #4f46e5; color: #fff; font-weight: 700; border: 2px solid #fff; box-shadow: 2px 4px 0 0 #ff3e7f22; }
        .sidebar-links a:hover:not(.active) { background: #ececff; color: #3b2fd6; border: 2px solid #d1d5fa; }
        .sidebar-footer { margin-top: auto; padding: 32px 32px 24px 32px; }
        .btn-logout { background: #fff; color: #4f46e5; border: none; padding: 12px 0; width: 100%; border-radius: 10px; font-weight: bold; font-size: 1.05em; cursor: pointer; transition: background 0.2s, color 0.2s; box-shadow: 0 2px 6px rgba(79,70,229,0.07); border: 2px solid transparent; outline: none; }
        .btn-logout:hover, .btn-logout:focus { background: #4f46e5; color: #fff; border: 2px solid #fff; }
        @media (max-width: 900px) { .sidebar { width: 100vw; min-height: auto; position: static; flex-direction: row; align-items: flex-start; padding: 10px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); font-size: 0.95em; } .sidebar-brand { font-size: 1.4rem; padding: 10px 10px 4px 10px; margin-bottom: 0; text-align: left; } .sidebar hr { display: none; } .sidebar-links { flex-direction: row; gap: 6px; padding: 0 8px 0 8px; } .sidebar-links a { font-size: 1em; padding: 10px 12px; margin-bottom: 0; } .sidebar-footer { padding: 8px 8px 10px 8px; } .btn-logout { padding: 10px 0; font-size: 1em; } }
    </style>
</head>
<body>

    <!-- Seu menu lateral -->
    <aside class="sidebar" id="sidebar">
        <a href="index.html" class="sidebar-brand">Pronti</a>
        <hr />
        <nav class="sidebar-links">
            <a href="dashboard.html"><span>üìä</span> Dashboard</a>
            <a href="servicos.html"><span>üõ†Ô∏è</span> Servi√ßos</a>
            <a href="agenda.html"><span>üìÖ</span> Agenda</a>
            <a href="clientes.html"><span>üë§</span> Clientes</a>
            <a href="equipe.html"><span>üë•</span> Equipe</a>
            <a href="perfil.html"><span>üôç‚Äç‚ôÇÔ∏è</span> Meu Perfil</a>
            <a href="relatorios.html"><span>üìà</span> Relat√≥rios</a>
            <a href="admin-clientes.html" class="active"><span>üîí</span> Administra√ß√£o</a>
        </nav>
        <div class="sidebar-footer">
            <button id="btn-logout" class="btn-logout">Sair</button>
        </div>
    </aside>

    <!-- Conte√∫do principal que ser√° preenchido pelo React -->
    <div class="main">
      <div id="root"></div>
    </div>

    <!-- Script do bot√£o de logout -->
    <script>
      // Seu script de logout aqui...
    </script>

    <!-- 4. Script principal com o c√≥digo React e Firebase -->
    <script type="text/babel">
        // Configura√ß√£o do Firebase (j√° com suas chaves)
        const firebaseConfig = {
            apiKey: "AIzaSyBOfsPIr0VLCuZsIzOFPsdm6kdhLb1VvP8",
            authDomain: "pronti-app-37c6e.firebaseapp.com",
            projectId: "pronti-app-37c6e",
            storageBucket: "pronti-app-37c6e.appspot.com",
            messagingSenderId: "736700619274",
            appId: "1:736700619274:web:557aa247905e56fa7e5df3"
        };

        // Inicializa o Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        const ADMIN_UID = "BX6Q7HrVMrcCBqe72r7K76EBPkX2";

        function AdminClientes() {
            const [user, setUser] = React.useState(null);
            const [empresas, setEmpresas] = React.useState([]);
            const [loading, setLoading] = React.useState(true);
            const [error, setError] = React.useState(null);

            React.useEffect(() => {
                const unsubscribe = auth.onAuthStateChanged(currentUser => {
                    setUser(currentUser);
                    if (!currentUser || currentUser.uid !== ADMIN_UID) {
                        setLoading(false);
                    }
                });
                return () => unsubscribe();
            }, []);

            const carregarEmpresas = React.useCallback(async () => {
                setLoading(true);
                setError(null);
                try {
                    const snap = await db.collection("empresarios").get();
                    const lista = await Promise.all(
                        snap.docs.map(async (empresaDoc) => {
                            const profSnap = await db.collection("empresarios").doc(empresaDoc.id).collection("profissionais").get();
                            return {
                                uid: empresaDoc.id,
                                ...empresaDoc.data(),
                                funcionarios: profSnap.docs.map(p => ({ id: p.id, ...p.data() }))
                            };
                        })
                    );
                    setEmpresas(lista);
                } catch (e) {
                    console.error("Erro ao carregar empresas:", e);
                    setError("Falha ao buscar dados: " + e.message);
                } finally {
                    setLoading(false);
                }
            }, []);

            React.useEffect(() => {
                if (user && user.uid === ADMIN_UID) {
                    carregarEmpresas();
                }
            }, [user, carregarEmpresas]);

            if (loading) {
                return <div className="loading">Carregando...</div>;
            }

            if (!user) {
                return <div className="restricted">Acesso negado. Por favor, fa√ßa o login.</div>;
            }

            if (user.uid !== ADMIN_UID) {
                return <div className="restricted">Acesso restrito. Apenas administradores.</div>;
            }
            
            if (error) {
                return <div className="restricted" style={{color: 'red'}}><strong>Erro:</strong> {error}</div>;
            }

            return (
                <div className="container">
                    <h2>Gest√£o de Empresas e Funcion√°rios</h2>
                    {empresas.length === 0 && <p>Nenhuma empresa encontrada.</p>}
                    {empresas.map(emp => (
                        <div className="empresa" key={emp.uid}>
                            {/* Seu c√≥digo para renderizar a empresa e funcion√°rios aqui... */}
                        </div>
                    ))}
                </div>
            );
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<AdminClientes />);
    </script>

</body>
</html>
