<!-- ================================================================== -->
<!--    SCRIPT DE VERIFICAÇÃO SIMPLIFICADO - FINAL DO <body>     -->
<!-- ================================================================== -->
<script type="module">
    // 1. Importa apenas o essencial para autenticação
    import { auth } from './firebase-config.js';
    import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    // Função para mostrar o conteúdo da página e esconder o "loading"
    function mostrarPagina( ) {
        // Esta função assume que você tem uma classe 'is-loading' no seu <body>
        // que o torna transparente. Se não, pode remover esta linha.
        document.body.classList.remove('is-loading');
        console.log("Página carregada e exibida.");
    }

    // 2. Observa o estado da autenticação
    onAuthStateChanged(auth, (user) => {
        
        // Adiciona uma pequena pausa para garantir que tudo inicializou
        setTimeout(() => {
            if (user) {
                // 3. Se o usuário ESTÁ logado:
                console.log("SUCESSO: Usuário está logado.", user.uid);
                console.log("Acesso liberado. A página deve carregar normalmente.");
                
                // Mostra o conteúdo da página
                mostrarPagina();

                // ** IMPORTANTE **
                // Todo o resto do seu código (para carregar o menu, nome do usuário, etc.)
                // deveria ser chamado a partir daqui.

            } else {
                // 4. Se o usuário NÃO ESTÁ logado:
                console.log("AVISO: Nenhum usuário logado. Redirecionando para login.html...");
                window.location.href = 'login.html';
            }
        }, 200); // Pausa de 200ms por segurança

    });
</script>
